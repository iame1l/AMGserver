## RC4加解密算法

在介绍RC4算法原理之前，先看看算法中的几个关键变量：

       1、密钥流：RC4算法的关键是根据明文和密钥生成相应的密钥流，密钥流的长度和明文的长度是对应的，也就是说明文的长度是500字节，那么密钥流也是500字节。当然，加密生成的密文也是500字节，因为密文第i字节=明文第i字节^密钥流第i字节；
    
       2、状态向量S：长度为256，S[0],S[1].....S[255]。每个单元都是一个字节，算法运行的任何时候，S都包括0-255的8比特数的排列组合，只不过值的位置发生了变换；
    
       3、临时向量T：长度也为256，每个单元也是一个字节。如果密钥的长度是256字节，就直接把密钥的值赋给T，否则，轮转地将密钥的每个字节赋给T；
    
       4、密钥K：长度为1-256字节，注意密钥的长度keylen与明文长度、密钥流的长度没有必然关系，通常密钥的长度趣味16字节（128比特）。
```C++
{//对称加密
	unsigned char tBox[MAX_LEN] = { 0 };
	memcpy(tBox, _box/*随机因子*/, MAX_LEN);

	int i = 0, j = 0, t = 0;
	unsigned long k = 0;
	unsigned char tmp;
	for (k = 0; k < len; k++)
	{
		i = (i + 1) % MAX_LEN;
		j = (j + tBox[i]) % MAX_LEN;
		tmp     = tBox[i];
		tBox[i] = tBox[j];
		tBox[j] = tmp;//交换,解密的时候换回来
		t = (tBox[i] + tBox[j]) % MAX_LEN;//生成密流
		data[k] ^= tBox[t];//对每个位进行操作
	}
}
```

